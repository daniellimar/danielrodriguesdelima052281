<div class="p-6 max-w-4xl mx-auto bg-white rounded-xl shadow-md mt-10 border border-gray-100">
  <div class="flex justify-between items-center mb-6">
    <h1 class="text-2xl font-bold text-gray-800">System Health Monitor</h1>
    <!-- Badge de Status Geral -->
    @if (health$ | async; as health) {
      <span [class]="health.readiness === 'UP' ? 'bg-green-100 text-green-700' : 'bg-red-100 text-red-700'"
            class="px-3 py-1 rounded-full text-xs font-bold animate-pulse">
        {{ health.readiness === 'UP' ? 'SISTEMA OPERACIONAL' : 'SISTEMA INST√ÅVEL' }}
      </span>
    }
  </div>

  @if (health$ | async; as health) {
    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
      <!-- Liveness -->
      <div class="p-4 rounded-lg border transition-all duration-300"
           [class]="health.liveness === 'UP' ? 'bg-green-50 border-green-200' : 'bg-red-50 border-red-200'">
        <div class="flex justify-between items-start">
          <span class="text-sm font-semibold uppercase text-gray-600">Liveness</span>
          <span [class]="health.liveness === 'UP' ? 'text-green-600' : 'text-red-600'">
             @if (health.liveness === 'UP') {
               ‚úÖ
             } @else {
               ‚ùå
             }
          </span>
        </div>
        <p class="text-2xl font-bold mt-1" [class]="health.liveness === 'UP' ? 'text-green-700' : 'text-red-700'">
          {{ health.liveness }}
        </p>
        <p class="text-xs text-gray-500 mt-2">Processo do servidor ativo e respondendo.</p>
      </div>

      <!-- Readiness -->
      <div class="p-4 rounded-lg border transition-all duration-300"
           [class]="health.readiness === 'UP' ? 'bg-blue-50 border-blue-200' : 'bg-red-50 border-red-200'">
        <div class="flex justify-between items-start">
          <span class="text-sm font-semibold uppercase text-gray-600">Readiness</span>
          <span [class]="health.readiness === 'UP' ? 'text-blue-600' : 'text-red-600'">
            @if (health.readiness === 'UP') {
              üåê
            } @else {
              ‚ö†Ô∏è
            }
          </span>
        </div>
        <p class="text-2xl font-bold mt-1" [class]="health.readiness === 'UP' ? 'text-blue-700' : 'text-red-700'">
          {{ health.readiness }}
        </p>
        <p class="text-xs text-gray-500 mt-2">Capacidade de processar requisi√ß√µes de dados.</p>
      </div>
    </div>

    <!-- Detalhes T√©cnicos com Toggle (Opcional para S√™nior) -->
    <details class="group bg-gray-50 border border-gray-200 rounded-lg mb-6">
      <summary class="list-none p-4 cursor-pointer flex justify-between items-center">
        <span class="text-xs font-semibold text-gray-600 uppercase">Ver Detalhes T√©cnicos</span>
        <span class="text-gray-400 group-open:rotate-180 transition-transform">‚ñº</span>
      </summary>
      <div class="p-4 pt-0">
        <div class="bg-gray-900 rounded-lg p-4">
          <code class="text-blue-400 text-xs block mb-2">Endpoint: {{ health.endpoint }}</code>
          <pre class="text-green-400 text-xs overflow-auto">{{ health.details | json }}</pre>
        </div>
      </div>
    </details>
  }

  <!-- Bot√£o de Refresh Otimizado -->
  <button
    (click)="reload()"
    [disabled]="loading$ | async"
    class="w-full bg-gray-800 text-white py-3 rounded-lg hover:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all font-medium flex items-center justify-center gap-2"
  >
    @if (loading$ | async) {
      <span class="animate-spin">üîÑ</span> Verificando...
    } @else {
      <span>üîÑ</span> Atualizar Status
    }
  </button>

  <!-- Hist√≥rico com Empty State -->
  @if (history$ | async; as history) {
    <div class="mt-8">
      <h2 class="text-lg font-bold text-gray-800 mb-4 flex items-center gap-2">
        üìã Hist√≥rico <span class="text-xs font-normal text-gray-400">(√öltimas 10)</span>
      </h2>

      @if (history.length === 0) {
        <p class="text-center py-4 text-gray-400 italic border-2 border-dashed rounded-lg">Nenhum registro
          encontrado.</p>
      } @else {
        <div class="space-y-2 max-h-60 overflow-y-auto pr-2 custom-scrollbar">
          @for (log of history; track log.timestamp) {
            <div
              class="bg-gray-50 border border-gray-200 rounded-lg p-3 text-sm flex items-center justify-between hover:bg-gray-100 transition-colors">
              <span class="font-mono text-xs text-gray-500">
                {{ log.timestamp | date:'HH:mm:ss' }} - {{ log.timestamp | date:'dd/MM' }}
              </span>
              <div class="flex gap-2">
                <span [class]="log.liveness === 'UP' ? 'text-green-600' : 'text-red-600'"
                      class="font-bold">L:{{ log.liveness }}</span>
                <span [class]="log.readiness === 'UP' ? 'text-blue-600' : 'text-red-600'"
                      class="font-bold">R:{{ log.readiness }}</span>
              </div>
            </div>
          }
        </div>
      }
    </div>
  }
</div>
