<div class="max-w-2xl mx-auto p-6">
  <!-- Header -->
  <div class="mb-8">
    <button
      routerLink="/pets"
      class="flex items-center text-blue-600 hover:text-blue-800 mb-4 transition-colors">
      <span class="mr-2">‚Üê</span> Voltar
    </button>
    <h1 class="text-3xl font-bold text-gray-900">
      {{ isEditMode ? 'Editar Pet' : 'Cadastrar Novo Pet' }}
    </h1>
  </div>

  <!-- Formul√°rio -->
  <form [formGroup]="petForm" (ngSubmit)="onSubmit()" class="bg-white rounded-xl shadow-lg p-8 space-y-6">

    <!-- Upload de Foto -->
    <div class="flex flex-col items-center">
      <div class="relative w-40 h-40 mb-4">
        @if (previewUrl) {
          <img
            [src]="previewUrl"
            alt="Preview"
            class="w-full h-full object-cover rounded-full border-4 border-blue-100"
          />
        } @else {
          <div class="w-full h-full bg-gray-200 rounded-full flex items-center justify-center">
            <span class="text-gray-400 text-4xl">üì∑</span>
          </div>
        }
      </div>

      <label class="cursor-pointer bg-blue-50 hover:bg-blue-100 text-blue-600 px-4 py-2 rounded-lg transition-colors">
        <input
          type="file"
          accept="image/*"
          (change)="onFileSelected($event)"
          class="hidden"
        />
        Escolher Foto
      </label>
    </div>

    <!-- Nome -->
    <div>
      <label for="nome" class="block text-sm font-medium text-gray-700 mb-2">
        Nome do Pet *
      </label>
      <input
        id="nome"
        type="text"
        formControlName="nome"
        placeholder="Ex: Rex"
        class="w-full px-4 py-3 border border-gray-300 rounded-lg
               focus:ring-2 focus:ring-blue-500 focus:outline-none"
        [class.border-red-500]="nomeControl?.invalid && nomeControl?.touched"
      />
      @if (nomeControl?.invalid && nomeControl?.touched) {
        <p class="mt-1 text-sm text-red-600">
          @if (nomeControl?.errors?.['required']) {
            Nome √© obrigat√≥rio
          } @else if (nomeControl?.errors?.['minlength']) {
            Nome deve ter pelo menos 2 caracteres
          }
        </p>
      }
    </div>

    <!-- Ra√ßa -->
    <div>
      <label for="raca" class="block text-sm font-medium text-gray-700 mb-2">
        Ra√ßa *
      </label>
      <input
        id="raca"
        type="text"
        formControlName="raca"
        placeholder="Ex: Labrador"
        class="w-full px-4 py-3 border border-gray-300 rounded-lg
               focus:ring-2 focus:ring-blue-500 focus:outline-none"
        [class.border-red-500]="racaControl?.invalid && racaControl?.touched"
      />
      @if (racaControl?.invalid && racaControl?.touched) {
        <p class="mt-1 text-sm text-red-600">Ra√ßa √© obrigat√≥ria</p>
      }
    </div>

    <!-- Idade -->
    <div>
      <label for="idade" class="block text-sm font-medium text-gray-700 mb-2">
        Idade (anos) *
      </label>
      <input
        id="idade"
        type="number"
        formControlName="idade"
        placeholder="Ex: 3"
        min="0"
        max="30"
        class="w-full px-4 py-3 border border-gray-300 rounded-lg
               focus:ring-2 focus:ring-blue-500 focus:outline-none"
        [class.border-red-500]="idadeControl?.invalid && idadeControl?.touched"
      />
      @if (idadeControl?.invalid && idadeControl?.touched) {
        <p class="mt-1 text-sm text-red-600">
          @if (idadeControl?.errors?.['required']) {
            Idade √© obrigat√≥ria
          } @else if (idadeControl?.errors?.['min'] || idadeControl?.errors?.['max']) {
            Idade deve estar entre 0 e 30 anos
          }
        </p>
      }
    </div>

    <!-- Bot√µes -->
    <div class="flex gap-4 pt-4">
      <button
        type="button"
        routerLink="/pets"
        class="flex-1 px-6 py-3 border border-gray-300 rounded-lg
               hover:bg-gray-50 transition-colors font-medium">
        Cancelar
      </button>
      <button
        type="submit"
        [disabled]="loading$ | async"
        class="flex-1 px-6 py-3 bg-blue-600 text-white rounded-lg
               hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed
               transition-colors font-medium flex items-center justify-center">
        @if (loading$ | async) {
          <div class="animate-spin rounded-full h-5 w-5 border-b-2 border-white"></div>
        } @else {
          {{ isEditMode ? 'Salvar Altera√ß√µes' : 'Cadastrar Pet' }}
        }
      </button>
    </div>
  </form>
</div>
